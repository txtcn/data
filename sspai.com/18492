➜派早报：iQOO 5 系列正式发布、三星 Galaxy S20 FE 渲染图曝光等
https://sspai.com/post/62161	4050
<h2>iQOO 5 系列正式发布</h2><p>8 月 17 日，iQOO 召开新品发布会并正式推出 iQOO 5 系列手机，iQOO 5 系列全系搭载高通骁龙 865 移动平台、LPDDR5 内存和 UFS 3.1 闪存，其中 iQOO 5 采用 6.56 英寸、120Hz 刷新率柔性屏，后置配备由 5000 万像素主摄、1300 万像素广角、和 1300 万像素 2x 人像镜头组成的三摄模组，支持 55W 快充；iQOO 5 Pro系列则支持 120W 快充，搭载由 5000 万像素主摄、1300 万像素广角和 800万像素 5x 潜望镜头组成的三摄方案。</p><p>售价方面，iQOO 5 提供皓影与星溯两种配色版本，售价 3998 元起（8GB+128GB）；iQOO 5 Pro 和 BMW M Motorsport 合作，提供赛道版与传奇版两款配色设计，售价 4998 元起（8GB+256GB）。<a href="https://www.pingwest.com/w/216437">来源</a></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/18/112d51b57e35cbf0466bf8569ef7c3b7.jpg"></figure><h2>三星 Galaxy S20 FE 渲染图曝光</h2><p>近日，知名爆料博主 <a href="https://twitter.com/OnLeaks/status/1294702038589333507">@OnLeaks</a> 联合 PriceBaba 放出了一组疑似为三星 Galaxy S20 入门版本的渲染图，从渲染图来看该机将采用非曲面、居中打孔屏幕，同时配备整体模组尺寸相对更小的后置三摄。值得一提的是和去年入门款采用「Lite」命名不同，本次放出的机型名称叫做三星 Galaxy S20 FE (Fan Edition)。<a href="https://9to5google.com/2020/08/17/samsung-galaxy-s20-fe-renders-showcase-affordable-design-more/">来源</a></p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/18/335e0560ded7eb4cda22cdf29255fedc.png"></figure><h2>腾讯将于 8 月 19 日举办《健身环大冒险》线上发布会</h2><p>腾讯 Nintendo Switch 官方微博于 8 月 17 日晚发布消息，将于 8 月 19 日 20:00 举办国行《健身环大冒险》的线上发布活动，届时将介绍《健身环大冒险》的游戏内容，并公布游戏的发售时间及购买渠道，用户可以在腾讯视频、虎牙直播、斗鱼直播和 bilibili 直播观看。<a href="https://weibo.com/7229718199/JgmzbEsTv">来源</a></p><h2>录影应用 DoubleTake 支持 iPad Pro 机型</h2><p>由 FiLMiC 开发的录影应用 DoubleTake 今日更新 2.0 版本，加入了对 iPad Pro 的支持。DoubleTake 允许用户同时调用设备上的多个前后置镜头，同时拍摄不同焦段的视频，此前仅支持 iPhone XR、iPhone XS、iPhone 11/11 Pro 和第二代 iPhone SE。<a href="https://9to5mac.com/2020/08/17/filmic-doubletake-app-now-lets-you-record-multi-cam-videos-on-ipad-pro/">来源</a></p><h2>游戏《对马岛之鬼》将推出多人联机模式</h2><p>索尼通过其微博及博客公布了人气游戏大作《对马岛之鬼》的全新游戏模式——奇谈模式（《Ghost of Tsushima: Legends》）。在该模式下，玩家将可以通过 2 人组队或 4 人组队的方式参与任务和对战。目前已经公布的可选职业为武士（Samurai）、猎人（Hunter）、浪人（Ronin）及刺客（Assassin），玩家在不同的组队模式下可以体验全新的联机任务，并进行攻势生存战等。奇谈模式将于今年秋季向已购玩家免费提供。<a href="https://blog.playstation.com/2020/08/17/ghost-of-tsushima-legends-coming-to-ps4-fall-2020/">来源</a></p><h2>你可能错过的好文章</h2><ul><li><a href="https://sspai.com/post/61961" target="_blank">使用超级笔记后，我用看版重塑了阅读计划</a></li><li><a href="https://sspai.com/post/61724" target="_blank">在限定时间内做好更多重要的事：我的时间管理办法</a></li><li><a href="https://sspai.com/post/62147" target="_blank">派评｜近期值得关注的 App</a></li></ul><p style="margin-left:0px;">&gt; 下载少数派 <a href="https://sspai.com/page/client">客户端</a>、关注 <a href="https://sspai.com/s/J71e">少数派公众号</a>，了解科技圈每日新鲜事 📰</p><p style="margin-left:0px;">&gt; 实用、好用的&nbsp;<a href="https://sspai.com/mall/class/28" target="_blank">正版软件</a>，少数派为你呈现&nbsp;🚀</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>
➜在 iPad 上运行 Windows 是什么体验？UTM 虚拟机折腾指南
https://sspai.com/post/62092	13391
<h3 style="margin-left:0px;"><strong>Matrix 精选</strong></h3><p style="margin-left:0px;"><a href="https://sspai.com/matrix">Matrix</a> 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。</p><p style="margin-left:0px;">文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><p>在 iOS 上利用虚拟机软件运行 Windows 或 Linux 实际上并不是什么新鲜事，早在 2017 年，少数派就有 <a href="https://sspai.com/post/40848" target="_blank">文章</a> 进行了介绍。但在那时，这么做仅仅是为了怀旧、玩玩游戏。而现在，苹果赋予 iPad 的生产力元素越来越多，运行在 iOS/iPadOS 上的虚拟机则就有了更大的意义。</p><p>UTM 就是一款开源的虚拟机软件，它将 <a href="https://www.qemu.org/" target="_blank">QEMU</a> 移植到了 iOS 上，通过完整地模拟整个计算机硬件系统，可以让我们在 iOS 设备上运行 Windows、Linux 和 Android。甚至，<a href="https://twitter.com/jankais3r/status/1274043856821145602" target="_blank">Twitter</a> 上还有用户展示了在 iPad 上通过 UTM 运行老版本的 macOS，进而利用 Xcode 来进行 iOS 的开发工作的梦幻操作。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/13/04b99de01f85d971422392366a16df85.png"><figcaption>在 iPad 上进行 iOS 开发</figcaption></figure><h2>安装 UTM 主程序</h2><p>如果你有自己安装 ipa 文件的惯用方法，可跳过此段，直接进入创建虚拟机部分。或者你也可以先阅读体验部分，再来看看有没有必要安装 UTM。</p><p>鉴于其特殊性，UTM 无缘 App Store。因此，我们需要下载 ipa 文件，手动进行安装。UTM 官方推荐使用 <a href="https://altstore.io/" target="_blank">AltStore</a> 进行安装。ipa 文件可类比到 Android 下的 apk 文件，是 iOS 的应用安装包。不同的是，ipa 文件需要我们通过苹果开发者账户签名之后才可以安装到 iOS 设备上。正常情况下，这一过程应该通过 Xcode 完成。AltStore 则简化了这一过程，可以不用通过 Xcode 就可安装 ipa 文件，并提供管理上的便利。</p><p>首先，我们前往 GitHub 获取 UTM 最新的 <a href="https://github.com/utmapp/UTM/releases/latest" target="_blank">ipa 文件</a>，以及前往 <a href="https://altstore.io/" target="_blank">AltStore 官方网站</a> 获取 AltStore 的电脑端依赖软件 AltServer 相应平台的安装包。然后，在电脑上安装 AltServer，安装好后在 AltServer 中登录我们的 Apple ID 并菜单中安装邮箱插件。</p><p>接着，运行对应的邮件应用<sup class="ss-footnote" href="" title="在 macOS 上就是原生的「邮件」客户端，Windows 下的应用不详。" footnote-id="1">1</sup>，邮件应用须登录了我们 Apple ID 的绑定邮箱，在设置中启用 AltServer 插件。最后，将 iOS 设备用数据线连接到电脑上，在 AltServer 的菜单中向目标设备安装 AltStore。静候片刻，AltStore 就会出现在 iOS 设备的主屏幕上。</p><figure class="ss-imgRows" figcaption=""><img src="https://cdn.sspai.com//2020/08/16/b9c430ac711612f140dba00aab3a29b2.png" alt=""><img src="https://cdn.sspai.com//2020/08/16/2457a63f0c60ba00c8d86fd08695f4a6.png" alt=""></figure><p>安装 AltStore 后，<strong>保持电脑端的邮件应用和 AltServer 运行并确保 iOS 设备与电脑处于同一局域网</strong>。再将 UTM 的 ipa 文件传输到 iOS 设备上，启动 AltStore，在底部导航栏中选择 My Apps，轻触左上角的加号，选择 UTM 的 ipa 文件。很快，UTM 就会出现在我们的主屏幕上了。</p><p>回到 AltStore 的 My Apps 页面，我们会发现应用后都注明了该应用会在 7 天后失效，这是由于我们的 Apple ID 并没有购买苹果 99 美元每年的付费开发者账号，我们需要每 7 天重新对应用进行签名。在应用即将失效前一天，AltStore 会发送通知提醒我们，我们可以在电脑端启动 AltServer 和邮件应用，并点击 AltStore 的 My Apps 页面中的 Refresh All 字样来手动重新签名。</p><h2>在 UTM 中创建虚拟机</h2><p>UTM 的交互界面友好，并且提供了中文支持。但是必须注意，由于一个 iOS 的系统漏洞，<strong>在退出 UTM 时必须使用主界面左上角的叉按钮或者虚拟机运行时工具栏上的关闭按钮</strong>，不可以直接在 App 切换器里上滑 UTM 卡片来强制关闭。否则，UTM 可能无法启动或者导致死机，需要重启设备才能恢复正常。</p><p>在创建虚拟机前，我们需要先下载好欲安装的系统镜像，并导入到 iOS 设备上。轻触主界面右上角的加号按钮，可以调出创建虚拟机界面。我们可以看到，UTM 支持虚拟化多种架构和 CPU，但是如果你不知道这些选项的实际意义，请保留默认的架构和 CPU。</p><h3>内存</h3><p>iOS 的机制会强制关闭任何占用内存超过 40% 的应用，所以内存的设置需要谨慎。UTM 官方推荐我们将虚拟机内存设置为设备可用内存的 25%，这是因为 UTM 应用程序本身运行就需要占用内存，并且在虚拟机运行时，为提高运行效率，UTM 还会产生默认值为虚拟机内存四分之一的 JIT 缓存<sup class="ss-footnote" href="https://www.jianshu.com/p/2e1ead2159ed" title="UTM 的虚拟化原理是一个「翻译」代码的过程，将面向其它计算平台编写的平台的代码翻译为宿主机平台可执行的代码。有时，翻译时会遇到重复的内容，如果每次遇到重复的内容都重新翻译，就会使运行效率大大降低。为此，JIT，即 just in time（即时编译）技术会检测重复多次的代码，将其翻译结果直接保存在缓存中，从而避免「重复造轮子」现象带来的运行效率降低。" footnote-id="2">2</sup>。</p><p>如果你不清楚设备的可用内存，可以在虚拟创建完毕后，进入虚拟机的配置界面，在「CPU 和内存」选项中 UTM 会为我们列出设备的可用内存，再行设置。在监测到设置的内存过大时，UTM 会向我们发出警告，并且如果虚拟机正在运行中，UTM 会保存一份虚拟机当前状态的快照，以免产生问题。</p><h3>硬盘镜像</h3><p>接下来，我们需要加载镜像。这里的镜像实际上指的是虚拟机的硬盘。我们点开「加载镜像」选项，再轻触右上角的加号，继续点开「文件路径」，又有加号，轻触它就是了。</p><p>第一次，我们选择「创建」，不用管拓展名，随便给镜像取个名字，再设置大小，如果要安装 Windows，至少需要 10 GB 的硬盘大小，类比到一台真实的计算机，这一步相当于将硬盘用数据线连接到电脑上。</p><p>接下来，我们返回去选中我们刚才创建的镜像，确保镜像类型为 disk，类比到一台真实的计算机，这一步相当于对硬盘进行挂载。最后返回一次，我们的镜像就创建完了。我们可以创建多个镜像，类比到一台真实的计算机，就相当于多个物理硬盘。</p><p>接下来，我们重复刚才的动作。只是这次，我们选择「导入」我们导入的系统安装镜像，<strong>并将镜像类型改为 CD/DVD 镜像</strong>，这就相当于插入了系统安装盘。</p><p>UTM 会将我们的虚拟机以 .utm 文件的形式保存在「文件」应用中的 UTM 文件夹下，我们也可以通过将 .utm 文件传输到 UTM 文件夹中来快速导入别人 <a href="https://getutm.app/vms/" target="_blank">创建好的虚拟机</a>。我们创建了镜像后 UTM 不会马上在设备上占用这么多空间，而 .utm 文件的大小会在使用的过程中逐步增长，直到达到我们设置的镜像大小。</p><p>接下来，返回 UTM 主界面，启动虚拟机，我们就会引来经典的系统安装向导。且听小娜吟诗，待其消停后，我们可以看到虚拟机的系统桌面，此时点击工具栏<sup class="ss-footnote" href="" title="如果你隐藏了工具栏，可使用三指下滑的手势调出它。" footnote-id="3">3</sup>上的暂停按钮，UTM 会为我们保存一个虚拟机当前状态的快照。</p><p>然后再<strong>点击工具栏上的关闭按钮</strong>，回到 iOS 系统桌面重新打开 UTM，轻触虚拟机卡片下的 𝚒 按钮，进入虚拟机「配置」中的「驱动器」，删除导入的系统安装镜像。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/16/3546f57f6289892ca624c87244017bbc.jpeg"><figcaption>UTM 主界面</figcaption></figure><h3>虚拟机系统优化</h3><p>为了完整发挥虚拟机的性能，我们可以在虚拟机系统内安装一些工具，但这并不是必须的。</p><ul><li>QXL Driver：提供了更快的渲染速度，以及 retina 高清显示支持。</li><li>Spice WebDAV daemon：提供了虚拟机和宿主机的文件共享，使虚拟机系统可读改「文件」应用中的 UTM 文件夹中除 .utm 文件外的其它文件。</li><li>SPICE guest agent：提供了剪贴板同步等实用性功能。</li></ul><p>以上工具的安装包都可以 <a href="https://www.spice-space.org/download.html" target="_blank">在此</a> 获得，值得注意的是，直接下载 Guest 客户端即可，UTM 已经内置了服务端。以上工具仅在少数系统，如 Windows 和 Debian 上工作。</p><p>至此，我们的虚拟机就已经完全配置完成了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/16/b1d14cf6dfb1251bdba38b8da85d0350.jpeg"><figcaption>使用 UTM 在 iPad Pro 上安装的 Windows 7</figcaption></figure><h2>体验</h2><p>我安装 UTM 的设备是 iPad Pro 11吋第二代的蜂窝数据版本，A12X 的处理器，储存空间是 256 GB，UTM 显示我设备的可用内存是 3057 MB。在清空后台后，我给每个虚拟机分配了 1024 MB 内存，没有触发报警和强制关闭。</p><h3>性能</h3><p>说到虚拟机，大家最关心的莫过于性能。在上文中也有提及，UTM 实现虚拟机的方法是模拟整个计算机硬件系统，加之苹果并没用提供 A 系列芯片的虚拟化接口，导致整个虚拟机的运行效率差强人意。我安装 Windows 10 和 Android 9 都失败了，二者都可以正确安装，但是无法进入桌面。最后我安装成功的是 Windows 7 和 Android 4.4.4。在 Android 4.4.4 中，我使用了 Geekbench 3 进行了跑分，结果供大家参考。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/16/5b066b21d2b81413129f360eb1a93906.jpeg"><figcaption>Android 4.4.4 Geekbench 3 跑分结果</figcaption></figure><p>这个跑分大概是什么水平呢？我去大概翻找了一下历年来的 Android 旗舰，其中跑分最接近的是 2011 年发布的三星 Galaxy S II。当然这只是旗舰机，在后几年发布的非旗舰平板中，例如 2015 年发布的华为 T1-701U，和这个跑分也比较接近。</p><p>这个跑分如此低，有一个重要的原因，是 UTM 不支持虚拟多核处理器，虽然提供了相关的设置，但官方说尽量不要尝试更改。在运行 Android 4 的过程中，帧率很低，一些拖动操作也十分不跟手。</p><p>在 Windows 7 的体验过程中，IE 浏览器是可以正常使用的。众所周知，IE 浏览器的最大意义就是拿来下载其他浏览器。于是我尝试安装 Chrome，在运行安装的过程中，UTM 崩溃并导致了我的 iPad 死机。不过在运行 Windows 7 的过程中，并没有肉眼可见的卡顿，操作也十分流畅。或许 UTM 对 Windows 的支持更加友好。</p><h3>输入</h3><p>UTM 在输入上有着十分完美的体验。UTM 支持两种方式的输入，一种是「触屏模式」将触控屏幕模拟为触控板，一种是「平板模式」，顾名思义，效果就像直接在平板上运行的系统一样。这里面可圈可点是平板模式，在平板模式下，可以完美触控 Android 4，直接就像使用一台 Android 平板那么简单，我相信如果我安装了 Android 2，没有流畅度的困扰，使用体验可能真的和真正的 Android 平板不相上下。</p><p>Windows 7 下，可完美使用 Windows 的「笔和触控」相关功能。在性能更好的 iPad 设备上，如果可以成功安装 Windows 10 的话，应该可以完美使用 Windows 10 平板模式的相关功能，可惜流畅度估计还是不行（Surface 用户长吁一气）。</p><p>我将 Magic Mouse 用蓝牙连接到了我的 iPad，令我十分惊喜，可以直接用 Magic Mouse 操控虚拟机中的鼠标，辅以 iPad 上连接到键盘式智能双面夹，体验和一台真正的电脑别无二致。但是仍然有两个点是很遗憾的：</p><ol><li>UTM 无法输入 Apple Pencil 的压力传感数据。</li><li>我的键盘式智能双面夹是日语的 JIS 布局，这似乎无法正确在虚拟机中映射。</li></ol><h3>可能性</h3><p>依我愚见，生产是一个开放创造力的过程，而生产力设备，则应给我们提供开放创造力的条件，给我们提供尽可能多的可能性，以供我们的创造力恣意发挥。一个优秀的生产力设备，应该在「可能性」与「易用性」中达到一个平衡点。UTM 的出现，无疑扩大了 iPad 的可能性，拓展了其生产力。</p><p>针对 Linux 系统，UTM 提供了命令行模式，可以让我们使用 UTM 内建的终端连接到虚拟机，发送命令，进行操作。UTM 也给虚拟机提供了健全的网络设置。这也就是说我们可以在 UTM 上运行 Linux，作为一个小型的服务器。这对一部分开发人员，可能是有一些用处的。在 Windows 上，我们也可以运行 Office 套件，来达成一些办公需求。也别忘了本文的开头，在 iPad 上进行 iOS 开发已经成为现实。</p><p>今年的 WWDC，宣告了 arm 处理器的 Mac 的信息。这又扩大了 UTM 的意义。x86 和 arm 是两个截然不同的平台，在 arm Mac 上，Parallels Desktop 这类 Mac 老牌虚拟机软件能不能工作，也许是个问题。此时，UTM 就占据了优势。根据 UTM 官方的消息，UTM 2.0 正在开发过程中，已经完成的有 UI 优化和对 macOS Big Sur 的支持。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/16/66678696d9f19846026a0145e7159bf6.png"><figcaption>有关 UTM for macOS Big Sur 的消息</figcaption></figure><p>UTM 的出现，拓展了 iPad 的生产力新可能；说不定在 ARM Mac 上，苹果能放开一些虚拟化的接口，那时完善了易用性的 UTM，说不定真可以掀起一番浪花。</p><p>虽然本文注重 UTM 在 iPad 上的体验，但 UTM 在 iPhone 上也是可以正常运行的。如果你对 UTM 感兴趣，可以前往其 <a href="https://getutm.app/" target="_blank">官方网站</a> 更进一步地了解 UTM，其源代码亦在 <a href="https://github.com/utmapp/" target="_blank">GitHub</a> 开源。</p><p style="margin-left:0px;">&gt; 下载少数派&nbsp;<a href="https://sspai.com/page/client">客户端</a>、关注&nbsp;<a href="https://sspai.com/s/J71e">少数派公众号</a>，发现更多有趣技巧 💻</p><p style="margin-left:0px;">&gt; 特惠、好用的硬件产品，尽在&nbsp;<a href="https://shop549593764.taobao.com/?spm=a230r.7195193.1997079397.2.2ddc7e0bPqKQHc">少数派sspai官方店铺</a>&nbsp;🛒</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>
➜UFS 3.1 是如何让 App 启动、加载速度更快的？
https://sspai.com/post/62151	21246
<p>你可能不知道的是，售价 3699 元起的小米 10 系列手机，顺序写入速度可能还比不上售价 2699 元的 Redmi K30 Pro。这是因为后者采用的是 UFS 3.1 闪存标准，其自带的 Write Turbo 技术可以把 K30 Pro 的顺序写入速率峰值提高到 750MB/s。</p><p>就像红米 Redmi 品牌总经理卢伟冰在这条 <a href="https://weibo.com/1892653244/Iz1tPBCRm" target="_blank">微博</a> 中解释的那样，虽然早期的 UFS 3.0 速度确实不算快，但今年最新的 UFS 3.0 在引入下放后的 Write Turbo 技术后，速率比起早期的 UFS 3.0 其实已经有了较大幅度的提升，「达到了接近 UFS 3.1 的级别」。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/18/02e012e8b8514d4f56fb9b3a88390cc2.png"><figcaption>从图中可以看到搭载 UFS 3.1 的 K30 Pro 在顺序写入这一项提升明显。<a href="http://t.cn/A6z0Gx7x?m=4483471738967516&amp;u=1892653244" target="_blank">来源</a></figcaption></figure><p>换句话说，即便对 UFS 3.0 而言，不同机型的实际读写速率可能也会有着较大的差距。要了解这种差距形成的原因，我们就得从 UFS 3.1 和从它下放而来的 Write Turbo 技术说起。</p><h2>远不止更大的带宽</h2><p>UFS 3.0 给我们用户带来了几乎是上一代（UFS 2.0）2.5 倍左右的传输带宽，再配合双通道的优势，使得最大总带宽达到了 2900 MB/s 这样恐怖的数字，完全可以满足各式各样的苛刻的使用需求。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2020/08/17/article/46c4c7f131c83840214ec6e994b77494"><figcaption>UFS 速度对比（图片来自 Wikipedia）</figcaption></figure><p>而今天要介绍的 UFS 3.1 作为 UFS 3.0 的升级版，除了继承了 UFS 3.0 速度以外，还添加了下列额外功能，开头所提到的 Write Turbo 就是其一：</p><ul><li>DeepSleep</li><li>Performance Throttling Notification</li><li>Write Turbo</li><li>HPB</li></ul><h3>DeepSleep</h3><p>我们的手机也有低功耗状态，可以在待机时极大减少能源开销。而这次 UFS 3.1 中的 DeepSleep 就是一种 UFS 的低功耗状态。在设备进入低功耗状态时，UFS 也会跟着主动进入 DeepSleep，减少能源开销。这样手机这类设备在待机时候会消耗的电量会更少了。</p><h3>Performance Throttling Notification</h3><p>照字面意思来看，Performance Throttling Notification 就是「性能限制通知」。什么时候需要限制性能？也许我们立马会联想到手机在过热时为了保护内部元器件与电池所做的降频温控措施。</p><p>而对于 UFS 闪存来说，较高的温度对于闪存的影响很大，<a href="http://users.ece.cmu.edu/~omutlu/pub/flash-memory-failures-in-the-field-at-facebook_sigmetrics15.pdf">Facebook 实验室的研究表明</a>：高温不仅让闪存的速度下降，也会提高写入数据时的出错率，导致需要反复写入数据，闪存磨损加剧。</p><p>通过「性能限制通知」这个功能，当温度升高到不能接受的地步时，UFS 设备可以告知系统该情况，让系统进行智能调配，通过降低速度或者其他手段，更安全可靠地读取和写入数据。</p><h3>Write Turbo</h3><p>对于一些硬件玩家来说，Write Turbo 写入加速功能的原理其实并不陌生，正是用到了一项已经在 SSD 固态硬盘用了很长一段时间的 SLC 缓存技术来加速写入速度。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/17/487e489a11cfacb4d41c24575c51e32c.png"><figcaption>SLC、MLC、TLC 和 QLC 对比（图片来自回形针 PaperClip）</figcaption></figure><p>SLC 是一种 <a href="https://www.bilibili.com/video/BV17t411c7qg">NAND 闪存类型</a>，它每个单元只能存储 0 或者 1，也就是 1bit 的数据；后来随着技术的发展，逐渐出现了 MLC（能存储 2bit）、TLC（能存储 3bit）、QLC（能存储 4bit）的闪存。每个单元能存储更多的数据，也能够<strong>大幅度降低闪存的价格</strong>，但是也会导致读取写入的速度变慢以及 <a href="https://www.bilibili.com/video/BV1n4411G7s5">更短的闪存寿命</a>。</p><p>可能有很多人还是不能理解为什么每个单元能存储更多的数据反而会导致写入性能会下降。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/17/6d97127a0b5e1634bb1e2f8df6a3a3bc.png"><figcaption>SLC 写入数据时的原理（图片来自回形针 PaperClip）</figcaption></figure><p>首先 SLC 闪存写入时，先需要将每个单元的做一次「擦除」，将电子吸出存储单元，让这个单元还原成 1。当我们想要写入 0 的时候，需要在顶层的控制极施加一个电压，让电子吸回存储单元。</p><p>而 TLC 闪存写入时，也先需要将每个单元的做一次「擦除」，将电子吸出存储单元，让这个单元还原成 111。当我们想要写入 010 的时候，顶层的控制极要做的操作远比 SLC <strong>复杂</strong>很多，才能精准地将表示 010 需要的电子吸入存储单元，来写入 010 这个数据，加上这个过程还是有概率会出现错误的，这样就需要重新写入一次。打个不恰当的例子来说，就是 TLC 的密度高导致电子「路窄不好走」，这也是为什么 TLC 要比 SLC 写入速度慢很多的原因。</p><p>聪明的厂商想到一个办法：不如将 UFS 上部分 TLC 单元的 TLC 的电位进行屏蔽，让它模拟成 SLC 来使用，那这样写入速度不就会快很多了？</p><p>确实如此，这部分模拟成 SLC 以后能极大幅度地加速写入速度，而这部分模拟成 SLC 的单元就被叫做 SLC 缓存。在写入完成了以后，UFS 会在后台将 SLC 缓存里的数据慢慢挪到 TLC 单元里。</p><figure class="image ss-img-wrapper image_resized" style="width:357px;"><img src="https://cdn.sspai.com//2020/08/17/c7c1269bcd05ee9648ebb8bdcc521d1d.png"><figcaption>一块因为缓存用完的 SSD</figcaption></figure><p>但是缓存大小也是有限制的，当我们写入的数据将缓存全部用掉以后，UFS 只能直接把数据放到 TLC 单元里去，这时候我们看见的写入速度就是真实的写入速度了。不过好在用户在手机上很少需要写入大量数据的时候，所以 Write Turbo 这样的技术理论上既能提高用户体验，又能降低制造成本。</p><h3>HPB</h3><p>HPB 功能则旨在让系统读取数据时更快。但在 UFS 3.1 中这是个可选功能。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2019/09/18/0ef908c7494be78aaa8ce430500b92c5.jpg?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1"><figcaption>重定位磁区无时不刻保护着我们数据的安全</figcaption></figure><p>任何存储设备存储数据时都是有逻辑位置和物理位置的。在某一块损坏以后，硬盘会会通过备用的磁区进行替换，也就是将备用的磁区通过映射的方法与坏磁区联系起来，当硬盘要写入坏的磁区时会直接跳转到映射的备用磁区上，保证数据写入的安全。读取时也同样是如此。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com//2020/08/17/299842fe24cf1c3e58a614ae8b2c8146.png"><figcaption>逻辑位置和物理位置并不一一对应</figcaption></figure><p>在发生映射关系以后，数据的逻辑位置并没有发生改变，但是物理位置发生了改变。每次使用时，主控都要通过逻辑位置和物理位置映射表才能找到这样的映射关系，这会大幅拖慢读取时的延迟。</p><p>HPB 的主要功能就是让 UFS 的主控可以把数据的逻辑位置和物理位置映射表缓存在手机内存中，这样系统就可以用很短的时间告诉主控，系统分别要哪些物理位置上数据，相比过去系统通过逻辑位置访问数据，延迟会大大降低。 利用 HPB 可以大幅降低随机读取时所需要的延迟，提高性能。</p><h2>UFS 3.1 带来的好处？</h2><figure class="image ss-img-wrapper image_resized" style="width:278px;"><img src="https://cdn.sspai.com//2020/08/17/157251a5a08eeeff14df05b00b24df07.png"><figcaption>利用 AndroBench 给自己的手机测个速，猜猜这是什么存储芯片？</figcaption></figure><p>UFS 3.1 给我们带来的最直观的好处就是，安装软件和启动软件的时候所用到的时间大大减少了。尤其是在大型软件和游戏中的时候感觉更加明显，启动和加载特别快。</p><p>通过 UFS 3.1 的 DeepSleep 功能还会让手机在待机的时候更加省电；而性能限制通知功能能让系统调度起来更加游刃有余，在高温环境下使用的时候也会变得更加顺畅。</p><p>最后就是 UFS 的成本会更低了。Write Turbo 让厂商大胆放心的使用 TLC 单元甚至 QLC 单元的 NAND 闪存作为存储器；而利用好 HPB 功能还可以减少了存储器闪存的 UFS 主控的成本。这两向加起来，用户就可以用更低的价格买到更大存储量的手机了。</p><p>以上就是 UFS 3.1 带来的新特性和能给我们带来的好处，希望它能帮助到你。</p><p>© 本文着作权归作者所有，并授权少数派独家使用，未经少数派许可，不得转载使用。</p>